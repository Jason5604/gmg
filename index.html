<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>学生成绩查询系统</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入SheetJS用于处理Excel文件 -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3b82f6',
            secondary: '#6366f1',
            accent: '#10b981',
            neutral: '#64748b',
            light: '#f1f5f9',
            dark: '#1e293b'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .watermark {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: -1;
        opacity: 0.1;
        pointer-events: none;
        transform: rotate(-15deg);
        font-size: 150px;
        font-weight: bold;
        color: #000;
      }
      .card-shadow {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .pulse {
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- 水印 -->
  <div class="watermark">@叶天哲</div>
  
  <div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- 头部 -->
    <header class="text-center mb-12 fade-in">
      <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-primary mb-4">学生成绩查询系统</h1>
      <p class="text-gray-600 text-lg max-w-2xl mx-auto">输入您的考号和姓名，查询最新考试成绩及排名信息</p>
    </header>
    
    <!-- 查询区域 -->
    <section class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8 fade-in" style="animation-delay: 0.1s">
      <form id="searchForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="examId" class="block text-gray-700 font-medium mb-2">考号 <span class="text-red-500">*</span></label>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                <i class="fa fa-id-card"></i>
              </span>
              <input type="text" id="examId" name="examId" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition duration-300"
                placeholder="请输入考号">
            </div>
          </div>
          
          <div>
            <label for="name" class="block text-gray-700 font-medium mb-2">姓名 <span class="text-red-500">*</span></label>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                <i class="fa fa-user"></i>
              </span>
              <input type="text" id="name" name="name" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition duration-300"
                placeholder="请输入姓名">
            </div>
          </div>
        </div>
        
        <div class="text-center">
          <button type="submit" id="searchBtn" 
            class="bg-primary hover:bg-primary/90 text-white font-semibold px-8 py-3 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50">
            <i class="fa fa-search mr-2"></i>查询成绩
          </button>
        </div>
      </form>
      
      <!-- 状态提示 -->
      <div id="status" class="mt-4 hidden"></div>
    </section>
    
    <!-- 结果展示区域 -->
    <section id="resultSection" class="hidden fade-in">
      <!-- 学生基本信息 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-user-circle text-primary mr-2"></i>学生基本信息
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">学校</p>
            <p id="school" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">班级</p>
            <p id="class" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">考号</p>
            <p id="studentExamId" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">选科</p>
            <p id="subject" class="font-medium text-lg"></p>
          </div>
        </div>
      </div>
      
      <!-- 总分信息 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-line-chart text-primary mr-2"></i>总分及排名
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tl-lg">项目</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分数</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">全体名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">区县名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">校名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tr-lg">班名次</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr id="totalScore1">
                <td class="px-4 py-3 text-sm font-medium text-gray-900">总分(物理)(赋分)</td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)总分"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向全体名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向区县名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向校名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向班名次"></td>
              </tr>
              <tr id="totalScore2">
                <td class="px-4 py-3 text-sm font-medium text-gray-900">总分(物理)</td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)总分"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向全体名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向区县名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向校名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向班名次"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- 各科成绩 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-book text-primary mr-2"></i>各科成绩及排名
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- 文科 -->
          <div>
            <h3 class="text-xl font-semibold text-gray-700 mb-4">
              <i class="fa fa-pencil-square-o text-secondary mr-2"></i>主要科目
            </h3>
            <div class="space-y-4">
              <!-- 语文 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">语文</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="语文分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="语文方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="语文方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="语文方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="语文方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 数学 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">数学</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="数学分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="数学方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="数学方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="数学方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="数学方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 英语 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">英语</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="英语分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="英语方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="英语方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="英语方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="英语方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 物理 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">物理</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="物理分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="物理方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="物理方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="物理方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="物理方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 选考科目 -->
          <div>
            <h3 class="text-xl font-semibold text-gray-700 mb-4">
              <i class="fa fa-graduation-cap text-secondary mr-2"></i>选考科目
            </h3>
            <div class="space-y-4">
              <!-- 化学 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">化学</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="化学分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="化学(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="化学(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="化学方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="化学方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 生物 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">生物</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="生物分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="生物(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="生物(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="生物方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="生物方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 政治 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">政治</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="政治分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="政治(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="政治(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="政治方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="政治方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 地理 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">地理</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="地理分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="地理(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="地理(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="地理方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="地理方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 小语种 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">小语种</h4>
                <div class="text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="小语种" class="font-medium"></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 重新查询按钮 -->
      <div class="text-center mb-8">
        <button id="resetBtn" 
          class="bg-gray-600 hover:bg-gray-700 text-white font-semibold px-8 py-3 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none">
          <i class="fa fa-refresh mr-2"></i>重新查询
        </button>
      </div>
    </section>
    
    <!-- 页脚 -->
    <footer class="text-center text-gray-500 text-sm py-6">
      <p>© 2023 学生成绩查询系统 | 数据仅供参考</p>
    </footer>
  </div>
  
  <!-- JavaScript -->
  <script>
    // 全局变量存储学生数据
    let studentData = [];
    
    // DOM元素
    const searchForm = document.getElementById('searchForm');
    const examIdInput = document.getElementById('examId');
    const nameInput = document.getElementById('name');
    const resultSection = document.getElementById('resultSection');
    const statusElement = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    
    // 页面加载时加载数据
    document.addEventListener('DOMContentLoaded', () => {
      loadData();
    });
    
    // 加载Excel数据
    async function loadData() {
      showStatus('正在加载数据，请稍候...', 'info');
      
      try {
        const response = await fetch('./data.xlsx');
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        
        // 获取所有表名
        const sheetNames = workbook.SheetNames;
        
        // 处理所有表格
        for (const sheetName of sheetNames) {
          const worksheet = workbook.Sheets[sheetName];
          
          // 转换为JSON
          const sheetData = XLSX.utils.sheet_to_json(worksheet);
          
          // 将每个表格的数据添加到学生数据中
          studentData = [...studentData, ...sheetData];
        }
        
        if (studentData.length === 0) {
          throw new Error('Excel文件中未找到数据');
        }
        
        showStatus(`成功加载 ${studentData.length} 条学生数据`, 'success');
      } catch (error) {
        showStatus(`加载数据失败: ${error.message}`, 'error');
        console.error('Error loading data:', error);
      }
    }
    
    // 显示状态信息
    function showStatus(message, type) {
      statusElement.textContent = message;
      statusElement.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800', 'p-3', 'rounded-lg');
      
      switch (type) {
        case 'success':
          statusElement.classList.add('bg-green-100', 'text-green-800', 'p-3', 'rounded-lg');
          break;
        case 'error':
          statusElement.classList.add('bg-red-100', 'text-red-800', 'p-3', 'rounded-lg');
          break;
        case 'info':
        default:
          statusElement.classList.add('bg-blue-100', 'text-blue-800', 'p-3', 'rounded-lg');
          break;
      }
    }
    
    // 处理表单提交
    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const examId = examIdInput.value.trim();
      const name = nameInput.value.trim();
      
      if (!examId || !name) {
        showStatus('请输入考号和姓名', 'error');
        return;
      }
      
      // 查找学生数据
      const student = findStudent(examId, name);
      
      if (student) {
        showStatus('', '');
        displayResult(student);
        resultSection.classList.remove('hidden');
        // 滚动到结果区域
        resultSection.scrollIntoView({ behavior: 'smooth' });
      } else {
        showStatus('未找到匹配的学生信息，请检查考号和姓名是否正确', 'error');
        resultSection.classList.add('hidden');
      }
    });
    
    // 查找学生
    function findStudent(examId, name) {
      return studentData.find(s => 
        s['考号']?.toString() === examId && 
        s['姓名']?.toString() === name
      );
    }
    
    // 显示查询结果
    function displayResult(student) {
      // 解析数据为数组形式
      const dataArray = Object.values(student);
      const dataKeys = Object.keys(student);
      
      // 显示基本信息
      document.getElementById('school').textContent = getValue(student, '学校');
      document.getElementById('class').textContent = getValue(student, '班级');
      document.getElementById('studentExamId').textContent = getValue(student, '考号');
      document.getElementById('name').textContent = getValue(student, '姓名');
      document.getElementById('subject').textContent = getValue(student, '选科');
      
      // 填充所有数据字段
      document.querySelectorAll('[data-field]').forEach(element => {
        const field = element.getAttribute('data-field');
        const index = dataKeys.indexOf(field);
        
        if (index !== -1) {
          // 使用索引方式获取值 [0][1][2]
          element.textContent = dataArray[index] !== undefined ? dataArray[index] : '-';
        } else {
          element.textContent = '-';
        }
      });
    }
    
    // 获取值，处理undefined情况
    function getValue(obj, key) {
      return obj[key] !== undefined ? obj[key] : '-';
    }
    
    // 重置表单
    resetBtn.addEventListener('click', () => {
      searchForm.reset();
      resultSection.classList.add('hidden');
      showStatus('', '');
      examIdInput.focus();
    });
  </script>
</body>
</html>
