<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>学生成绩查询系统</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入SheetJS用于处理Excel文件 -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3b82f6',
            secondary: '#6366f1',
            accent: '#10b981',
            neutral: '#64748b',
            light: '#f1f5f9',
            dark: '#1e293b'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .watermark {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: -1;
        opacity: 0.1;
        pointer-events: none;
        transform: rotate(-15deg);
        font-size: 150px;
        font-weight: bold;
        color: #000;
      }
      .card-shadow {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .pulse {
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
      }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- 水印 -->
  <div class="watermark">@叶天哲</div>
  
  <div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- 头部 -->
    <header class="text-center mb-12 fade-in">
      <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-primary mb-4">学生成绩查询系统</h1>
      <p class="text-gray-600 text-lg max-w-2xl mx-auto">输入考号或姓名，查询最新考试成绩及排名信息</p>
    </header>
    
    <!-- 查询区域 -->
    <section class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8 fade-in" style="animation-delay: 0.1s">
      <form id="searchForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label for="searchValue" class="block text-gray-700 font-medium mb-2">考号或姓名 <span class="text-red-500">*</span></label>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                <i class="fa fa-search"></i>
              </span>
              <input type="text" id="searchValue" name="searchValue" required
                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition duration-300"
                placeholder="请输入考号或姓名">
            </div>
          </div>
          
          <div>
            <label for="searchType" class="block text-gray-700 font-medium mb-2">查询方式</label>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                <i class="fa fa-filter"></i>
              </span>
              <select id="searchType" name="searchType" 
                class="w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition duration-300 appearance-none bg-white">
                <option value="both">考号或姓名</option>
                <option value="examId">仅考号</option>
                <option value="name">仅姓名</option>
              </select>
              <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-500">
                <i class="fa fa-chevron-down"></i>
              </div>
            </div>
          </div>
        </div>
        
        <div class="text-center">
          <button type="submit" id="searchBtn" 
            class="bg-primary hover:bg-primary/90 text-white font-semibold px-8 py-3 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50">
            <i class="fa fa-search mr-2"></i>查询成绩
          </button>
        </div>
      </form>
      
      <!-- 状态提示 -->
      <div id="status" class="mt-4 hidden"></div>
      
      <!-- 重名选择区域 -->
      <div id="multipleResults" class="mt-6 hidden">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">找到多个同名学生，请选择：</h3>
        <div id="studentList" class="space-y-3"></div>
      </div>
    </section>
    
    <!-- 结果展示区域 -->
    <section id="resultSection" class="hidden fade-in">
      <!-- 学生基本信息 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-user-circle text-primary mr-2"></i>学生基本信息
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">学校</p>
            <p id="school" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">班级</p>
            <p id="class" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">考号</p>
            <p id="studentExamId" class="font-medium text-lg"></p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg">
            <p class="text-gray-500 text-sm mb-1">选科</p>
            <p id="subject" class="font-medium text-lg"></p>
          </div>
        </div>
      </div>
      
      <!-- 总分信息 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-line-chart text-primary mr-2"></i>总分及排名
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tl-lg">项目</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">分数</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">全体名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">区县名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">校名次</th>
                <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider rounded-tr-lg">班名次</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr id="totalScore1">
                <td class="px-4 py-3 text-sm font-medium text-gray-900">总分(物理)(赋分)</td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)分数"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向全体名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向区县名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向校名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)(赋分)方向班名次"></td>
              </tr>
              <tr id="totalScore2">
                <td class="px-4 py-3 text-sm font-medium text-gray-900">总分(物理)</td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)分数"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向全体名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向区县名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向校名次"></td>
                <td class="px-4 py-3 text-sm text-gray-500" data-field="总分(物理)方向班名次"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- 各科成绩 -->
      <div class="bg-white rounded-xl p-6 md:p-8 card-shadow mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">
          <i class="fa fa-book text-primary mr-2"></i>各科成绩及排名
        </h2>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- 文科 -->
          <div>
            <h3 class="text-xl font-semibold text-gray-700 mb-4">
              <i class="fa fa-pencil-square-o text-secondary mr-2"></i>主要科目
            </h3>
            <div class="space-y-4">
              <!-- 语文 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">语文</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="语文分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="语文方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="语文方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="语文方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="语文方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 数学 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">数学</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="数学分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="数学方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="数学方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="数学方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="数学方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 英语 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">英语</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="英语分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="英语方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="英语方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="英语方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="英语方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 物理 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">物理</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="物理分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="物理方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">区县名次</p>
                    <p data-field="物理方向区县名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="物理方向校名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">班名次</p>
                    <p data-field="物理方向班名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 选考科目 -->
          <div>
            <h3 class="text-xl font-semibold text-gray-700 mb-4">
              <i class="fa fa-graduation-cap text-secondary mr-2"></i>选考科目
            </h3>
            <div class="space-y-4">
              <!-- 化学 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">化学</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="化学分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="化学(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="化学(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="化学(赋分)方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="化学(赋分)方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 生物 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">生物</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="生物分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="生物(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="生物(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="生物(赋分)方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="生物(赋分)方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 政治 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">政治</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="政治分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="政治(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="政治(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="政治(赋分)方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="政治(赋分)方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 地理 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">地理</h4>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="地理分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分分数</p>
                    <p data-field="地理(赋分)分数" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">赋分等级</p>
                    <p data-field="地理(赋分)等级" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">全体名次</p>
                    <p data-field="地理(赋分)方向全体名次" class="font-medium"></p>
                  </div>
                  <div>
                    <p class="text-gray-500">校名次</p>
                    <p data-field="地理(赋分)方向校名次" class="font-medium"></p>
                  </div>
                </div>
              </div>
              
              <!-- 小语种 -->
              <div class="bg-gray-50 p-4 rounded-lg">
                <h4 class="font-medium text-gray-800 mb-2">小语种</h4>
                <div class="text-sm">
                  <div>
                    <p class="text-gray-500">分数</p>
                    <p data-field="小语种分数" class="font-medium"></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 重新查询按钮 -->
      <div class="text-center mb-8">
        <button id="resetBtn" 
          class="bg-gray-600 hover:bg-gray-700 text-white font-semibold px-8 py-3 rounded-lg transition duration-300 transform hover:scale-105 focus:outline-none">
          <i class="fa fa-refresh mr-2"></i>重新查询
        </button>
      </div>
    </section>
    
    <!-- 页脚 -->
    <footer class="text-center text-gray-500 text-sm py-6">
      <p>© 2023 学生成绩查询系统 | 数据仅供参考</p>
    </footer>
  </div>
  
  <!-- JavaScript -->
  <script>
    // 全局变量存储学生数据
    let studentData = [];
    
    // DOM元素
    const searchForm = document.getElementById('searchForm');
    const searchValue = document.getElementById('searchValue');
    const searchType = document.getElementById('searchType');
    const resultSection = document.getElementById('resultSection');
    const statusElement = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const multipleResults = document.getElementById('multipleResults');
    const studentList = document.getElementById('studentList');
    
    // 页面加载时加载数据
    document.addEventListener('DOMContentLoaded', () => {
      loadData();
    });
    
    // 加载Excel数据
    async function loadData() {
      showStatus('正在加载数据，请稍候...', 'info');
      
      try {
        const response = await fetch('./data.xlsx');
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        
        // 获取所有表名
        const sheetNames = workbook.SheetNames;
        
        // 处理所有表格
        for (const sheetName of sheetNames) {
          const worksheet = workbook.Sheets[sheetName];
          
          // 转换为JSON
          const sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
          
          if (sheetData.length <= 1) continue; // 至少需要标题行和数据行
          
          // 处理合并单元格的表头
          const headers = processHeaders(sheetData);
          
          // 从第二行(index=1)开始加载数据
          for (let i = 1; i < sheetData.length; i++) {
            const row = sheetData[i];
            const student = {};
            
            headers.forEach((header, index) => {
              if (header && row[index] !== undefined) {
                student[header] = row[index];
              }
            });
            
            // 只添加有考号和姓名的数据
            if (student['考号'] && student['姓名']) {
              studentData.push(student);
            }
          }
        }
        
        if (studentData.length === 0) {
          throw new Error('Excel文件中未找到数据');
        }
        
        showStatus(`成功加载 ${studentData.length} 条学生数据`, 'success');
      } catch (error) {
        showStatus(`加载数据失败: ${error.message}`, 'error');
        console.error('Error loading data:', error);
      }
    }
    
    // 处理合并单元格的表头
    function processHeaders(sheetData) {
      // 假设前两行是合并的表头
      if (sheetData.length < 2) return [];
      
      const row1 = sheetData[0];
      const row2 = sheetData[1];
      const headers = [];
      
      for (let i = 0; i < row2.length; i++) {
        // 合并两个表头行
        let header = '';
        
        if (row1[i] && row1[i].trim()) {
          header += row1[i].trim();
          
          if (row2[i] && row2[i].trim() && row2[i] !== '分数' && row2[i] !== '等级') {
            header += ' ' + row2[i].trim();
          }
        } else if (row2[i] && row2[i].trim()) {
          header = row2[i].trim();
        }
        
        // 清理表头
        header = header
          .replace(/\s+/g, ' ')
          .replace(/\(|\)/g, '')
          .trim();
        
        // 为表头添加唯一标识
        if (header) {
          // 处理特殊情况
          if (header === '总分 物理 赋分') header = '总分(物理)(赋分)分数';
          else if (header === '总分 物理') header = '总分(物理)分数';
          else if (header === '小语种') header = '小语种分数';
          else if (header.includes('方向全体名次')) header = header.replace('方向全体名次', '') + '方向全体名次';
          else if (header.includes('方向区县名次')) header = header.replace('方向区县名次', '') + '方向区县名次';
          else if (header.includes('方向校名次')) header = header.replace('方向校名次', '') + '方向校名次';
          else if (header.includes('方向班名次')) header = header.replace('方向班名次', '') + '方向班名次';
          else if (!header.endsWith('分数') && !header.endsWith('等级')) header += '分数';
        }
        
        headers.push(header);
      }
      
      return headers;
    }
    
    // 显示状态信息
    function showStatus(message, type) {
      statusElement.textContent = message;
      statusElement.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800', 'p-3', 'rounded-lg');
      
      switch (type) {
        case 'success':
          statusElement.classList.add('bg-green-100', 'text-green-800', 'p-3', 'rounded-lg');
          break;
        case 'error':
          statusElement.classList.add('bg-red-100', 'text-red-800', 'p-3', 'rounded-lg');
          break;
        case 'info':
        default:
          statusElement.classList.add('bg-blue-100', 'text-blue-800', 'p-3', 'rounded-lg');
          break;
      }
    }
    
    // 处理表单提交
    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const value = searchValue.value.trim();
      const type = searchType.value;
      
      if (!value) {
        showStatus('请输入考号或姓名', 'error');
        return;
      }
      
      // 根据选择的查询方式查找学生
      let results = [];
      
      switch (type) {
        case 'examId':
          results = studentData.filter(s => s['考号']?.toString() === value);
          break;
        case 'name':
          results = studentData.filter(s => s['姓名']?.toString() === value);
          break;
        case 'both':
        default:
          // 先尝试考号匹配
          results = studentData.filter(s => s['考号']?.toString() === value);
          
          // 如果没有找到，再尝试姓名匹配
          if (results.length === 0) {
            results = studentData.filter(s => s['姓名']?.toString() === value);
          }
          break;
      }
      
      if (results.length === 0) {
        showStatus('未找到匹配的学生信息，请检查输入是否正确', 'error');
        resultSection.classList.add('hidden');
        multipleResults.classList.add('hidden');
      } else if (results.length === 1) {
        showStatus('', '');
        multipleResults.classList.add('hidden');
        displayResult(results[0]);
        resultSection.classList.remove('hidden');
        // 滚动到结果区域
        resultSection.scrollIntoView({ behavior: 'smooth' });
      } else {
        // 多个结果，显示选择列表
        showStatus('', '');
        resultSection.classList.add('hidden');
        showStudentList(results);
        multipleResults.classList.remove('hidden');
        // 滚动到选择区域
        multipleResults.scrollIntoView({ behavior: 'smooth' });
      }
    });
    
    // 显示学生列表供选择
    function showStudentList(students) {
      studentList.innerHTML = '';
      
      students.forEach(student => {
        const card = document.createElement('div');
        card.className = 'bg-white border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition duration-200 cursor-pointer';
        card.innerHTML = `
          <div class="flex items-center">
            <div class="mr-4 bg-primary text-white p-2 rounded-full">
              <i class="fa fa-user"></i>
            </div>
            <div>
              <p class="font-medium text-gray-900">${student['姓名']}</p>
              <p class="text-sm text-gray-600">考号: ${student['考号']}</p>
              <p class="text-sm text-gray-600">学校: ${student['学校'] || '-'}, 班级: ${student['班级'] || '-'}</p>
            </div>
          </div>
        `;
        
        card.addEventListener('click', () => {
          displayResult(student);
          resultSection.classList.remove('hidden');
          multipleResults.classList.add('hidden');
          // 滚动到结果区域
          resultSection.scrollIntoView({ behavior: 'smooth' });
        });
        
        studentList.appendChild(card);
      });
    }
    
    // 显示查询结果
    function displayResult(student) {
      // 显示基本信息
      document.getElementById('school').textContent = getValue(student, '学校');
      document.getElementById('class').textContent = getValue(student, '班级');
      document.getElementById('studentExamId').textContent = getValue(student, '考号');
      document.getElementById('name').textContent = getValue(student, '姓名');
      document.getElementById('subject').textContent = getValue(student, '选科');
      
      // 填充所有数据字段
      document.querySelectorAll('[data-field]').forEach(element => {
        const field = element.getAttribute('data-field');
        element.textContent = getValue(student, field);
      });
    }
    
    // 获取值，处理undefined情况
    function getValue(obj, key) {
      return obj[key] !== undefined ? obj[key] : '-';
    }
    
    // 重置表单
    resetBtn.addEventListener('click', () => {
      searchForm.reset();
      resultSection.classList.add('hidden');
      multipleResults.classList.add('hidden');
      showStatus('', '');
      searchValue.focus();
    });
  </script>
</body>
</html>
